2024/08/22 07:26:58 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 07:26:58 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 07:26:58 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 07:26:58 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 07:26:58 - AES_Enc - DEBUG - AES_columns_mac:UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN
2024/08/22 07:26:58 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 07:26:58 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 07:26:58 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 07:26:58 - AES_Enc - DEBUG - spark_import_service_ip_130.211.246.188
2024/08/22 07:27:08 - AES_Enc - DEBUG - updateTProjectStatus error: __init__() should return None, not 'bool'
2024/08/22 07:33:15 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 07:33:15 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 07:33:15 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 07:33:15 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 07:33:15 - AES_Enc - DEBUG - AES_columns_mac:UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN
2024/08/22 07:33:15 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 07:33:15 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 07:33:15 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 07:33:15 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/08/22 07:33:25 - AES_Enc - DEBUG - updateTProjectStatus error: __init__() should return None, not 'bool'
2024/08/22 07:53:19 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 07:53:19 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 07:53:19 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 07:53:19 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 07:53:19 - AES_Enc - DEBUG - AES_columns_mac:UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN
2024/08/22 07:53:19 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 07:53:19 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 07:53:19 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 07:53:19 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/08/22 07:53:29 - AES_Enc - DEBUG - updateTProjectStatus error: __init__() should return None, not 'bool'
2024/08/22 07:57:13 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 07:57:13 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 07:57:13 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 07:57:13 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 07:57:13 - AES_Enc - DEBUG - AES_columns_mac:UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN
2024/08/22 07:57:13 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 07:57:13 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 07:57:13 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 07:57:13 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/08/22 07:57:23 - AES_Enc - DEBUG - updateTProjectStatus error: __init__() should return None, not 'bool'
2024/08/22 08:15:42 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 08:15:42 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 08:15:42 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 08:15:42 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 08:15:42 - AES_Enc - DEBUG - AES_columns_mac:UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN
2024/08/22 08:15:42 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 08:15:42 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 08:15:42 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 08:15:42 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/08/22 08:15:42 - AES_Enc - DEBUG - project_cert = eyJncm91cF90eXBlIjoic3lzIiwiZW5jX2tleSI6Ijk1RUFGOTFEOTAxRThCMUM4REQ2M0U3Q0FEOTA0NDY4Q0VBMTcwREZDRDY4Q0IxQzgxNUQ5NDYwM0JCRUU5QTkiLCJwcm9qZWN0X25hbWUiOiJ0ZXN0MDgyMjEiLCJwcm9qZWN0X2ZvbGRlciI6InRlc3QwODIyMSIsInBldHNfc2VydmljZV9pcCI6InBlZHNhcy5tb2RhLmdvdi50dyJ9
2024/08/22 08:15:42 - AES_Enc - DEBUG - group_type = sys
2024/08/22 08:15:42 - AES_Enc - DEBUG - Mac_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:15:42 - AES_Enc - DEBUG - AES_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:15:42 - AES_Enc - DEBUG - AES key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:15:42 - AES_Enc - DEBUG - Mac key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:15:42 - AES_Enc - DEBUG - projName: test08221
2024/08/22 08:15:42 - AES_Enc - DEBUG - project_folder: test08221
2024/08/22 08:15:42 - AES_Enc - DEBUG - pets_service_ip : pedsas.moda.gov.tw
2024/08/22 08:15:42 - AES_Enc - DEBUG - AES password ok
2024/08/22 08:15:42 - AES_Enc - DEBUG - Mac password ok
2024/08/22 08:15:42 - AES_Enc - DEBUG - AES columns name will be maced: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 08:15:42 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 08:16:00 - AES_Enc - DEBUG - cmd is echo "citcw200@" | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 08:16:00 - AES_Enc - DEBUG - run result is 0
2024/08/22 08:16:00 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 08:16:00 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/08/22 08:16:00 - AES_Enc - DEBUG - ============start======================
2024/08/22 08:16:00 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 08:16:00 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 08:16:00 - AES_Enc - DEBUG - AES columns name will be maced: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 08:16:00 - AES_Enc - DEBUG - remove hdfs_path = /tmp/P1.csv
2024/08/22 08:16:01 - AES_Enc - DEBUG - remove hdfs file result = b'24/08/22 08:16:01 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n'
2024/08/22 08:16:01 - AES_Enc - DEBUG -  AAAAAAAAAA-P1.csv exist before , rm ok
2024/08/22 08:16:01 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/08/22 08:16:01 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 08:16:01 - AES_Enc - DEBUG - sep: ,
2024/08/22 08:16:01 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/P1.csv
2024/08/22 08:16:03 - AES_Enc - DEBUG - BBBBresult = b'24/08/22 08:16:02 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n'
2024/08/22 08:16:03 - AES_Enc - DEBUG - In readLocalData
2024/08/22 08:16:07 - AES_Enc - DEBUG - header valuse = ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 08:16:09 - AES_Enc - DEBUG - In checkListQuotes header
2024/08/22 08:16:09 - AES_Enc - DEBUG - In checkListQuotes record
2024/08/22 08:16:09 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/08/22 08:16:09 - AES_Enc - DEBUG - {'col_0': 'UID', 'col_1': 'RIDAGEYR', 'col_2': 'RIAGENDR', 'col_3': 'RIDRETH1', 'col_4': 'DMDCITZN'}
2024/08/22 08:16:09 - AES_Enc - DEBUG - ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 08:16:09 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 08:16:09 - AES_Enc - DEBUG -  readFrom_csv OK
2024/08/22 08:16:09 - AES_Enc - DEBUG - ============start2======================
2024/08/22 08:16:09 - AES_Enc - DEBUG - ###################out udfMac table name
2024/08/22 08:16:09 - AES_Enc - DEBUG - citc____P1
2024/08/22 08:16:09 - AES_Enc - DEBUG - ###################sc.applicationId
2024/08/22 08:16:09 - AES_Enc - DEBUG - citc____application_1724314517462_0001
2024/08/22 08:16:09 - AES_Enc - DEBUG - ---++++--cols: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 08:16:09 - AES_Enc - DEBUG - ---++++--AES key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:16:09 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/08/22 08:16:09 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/08/22 08:16:09 - AES_Enc - DEBUG - ---++++--MAC key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:16:09 - AES_Enc - DEBUG - enter
2024/08/22 08:16:09 - AES_Enc - DEBUG - enter
2024/08/22 08:16:09 - AES_Enc - DEBUG - in udfMacCols
2024/08/22 08:16:09 - AES_Enc - DEBUG - col finishy
2024/08/22 08:16:09 - AES_Enc - DEBUG - AES and MAC = ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN'] []
2024/08/22 08:16:09 - AES_Enc - DEBUG - col name before
2024/08/22 08:16:09 - AES_Enc - DEBUG - MAC_KEY = 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:16:09 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 08:16:09 - AES_Enc - DEBUG - before extend
2024/08/22 08:16:09 - AES_Enc - DEBUG - ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 08:16:09 - AES_Enc - DEBUG - before tmpList
2024/08/22 08:16:09 - AES_Enc - DEBUG - after tmpList
2024/08/22 08:16:09 - AES_Enc - DEBUG - <class 'pyspark.sql.utils.AnalysisException'>
2024/08/22 08:16:09 - AES_Enc - DEBUG - "cannot resolve '`UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN`' given input columns: [df_table__.col_2, df_table__.col_4, df_table__.col_0, df_table__.col_3, df_table__.col_1];;\n'Project ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN, 'UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN__]\n+- AnalysisBarrier\n      +- Project [col_0#26, col_1#27, col_2#28, col_3#29, col_4#30]\n         +- SubqueryAlias df_table__\n            +- Project [UID#10 AS col_0#26, RIDAGEYR#11 AS col_1#27, RIAGENDR#12 AS col_2#28, RIDRETH1#13 AS col_3#29, DMDCITZN#14 AS col_4#30]\n               +- Relation[UID#10,RIDAGEYR#11,RIAGENDR#12,RIDRETH1#13,DMDCITZN#14] csv\n"
2024/08/22 08:16:09 - AES_Enc - DEBUG - <traceback object at 0x73721fec6808>
2024/08/22 08:16:09 - AES_Enc - DEBUG - 3
2024/08/22 08:16:09 - AES_Enc - DEBUG - errTable_err_udfEncCols()
2024/08/22 08:23:40 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 08:23:40 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 08:23:40 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 08:23:40 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 08:23:40 - AES_Enc - DEBUG - AES_columns_mac:UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN
2024/08/22 08:23:40 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 08:23:40 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 08:23:40 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 08:23:40 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/08/22 08:23:40 - AES_Enc - DEBUG - project_cert = eyJncm91cF90eXBlIjoic3lzIiwiZW5jX2tleSI6Ijk1RUFGOTFEOTAxRThCMUM4REQ2M0U3Q0FEOTA0NDY4Q0VBMTcwREZDRDY4Q0IxQzgxNUQ5NDYwM0JCRUU5QTkiLCJwcm9qZWN0X25hbWUiOiJ0ZXN0MDgyMjEiLCJwcm9qZWN0X2ZvbGRlciI6InRlc3QwODIyMSIsInBldHNfc2VydmljZV9pcCI6InBlZHNhcy5tb2RhLmdvdi50dyJ9
2024/08/22 08:23:40 - AES_Enc - DEBUG - group_type = sys
2024/08/22 08:23:40 - AES_Enc - DEBUG - Mac_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:23:40 - AES_Enc - DEBUG - AES_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:23:40 - AES_Enc - DEBUG - AES key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:23:40 - AES_Enc - DEBUG - Mac key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:23:40 - AES_Enc - DEBUG - projName: test08221
2024/08/22 08:23:40 - AES_Enc - DEBUG - project_folder: test08221
2024/08/22 08:23:40 - AES_Enc - DEBUG - pets_service_ip : pedsas.moda.gov.tw
2024/08/22 08:23:40 - AES_Enc - DEBUG - AES password ok
2024/08/22 08:23:40 - AES_Enc - DEBUG - Mac password ok
2024/08/22 08:23:40 - AES_Enc - DEBUG - AES columns name will be maced: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 08:23:40 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 08:23:54 - AES_Enc - DEBUG - cmd is echo "citcw200@" | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 08:23:54 - AES_Enc - DEBUG - run result is 0
2024/08/22 08:23:54 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 08:23:54 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/08/22 08:23:54 - AES_Enc - DEBUG - ============start======================
2024/08/22 08:23:54 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 08:23:54 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 08:23:54 - AES_Enc - DEBUG - AES columns name will be maced: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 08:23:54 - AES_Enc - DEBUG - remove hdfs_path = /tmp/P1.csv
2024/08/22 08:23:56 - AES_Enc - DEBUG - remove hdfs file result = b'24/08/22 08:23:56 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.\n'
2024/08/22 08:23:56 - AES_Enc - DEBUG -  AAAAAAAAAA-P1.csv exist before , rm ok
2024/08/22 08:23:56 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/08/22 08:23:56 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 08:23:56 - AES_Enc - DEBUG - sep: ,
2024/08/22 08:23:56 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/P1.csv
2024/08/22 08:23:58 - AES_Enc - DEBUG - BBBBresult = 
2024/08/22 08:23:58 - AES_Enc - DEBUG - In readLocalData
2024/08/22 08:24:02 - AES_Enc - DEBUG - header valuse = ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 08:24:02 - AES_Enc - DEBUG - In checkListQuotes header
2024/08/22 08:24:02 - AES_Enc - DEBUG - In checkListQuotes record
2024/08/22 08:24:02 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/08/22 08:24:02 - AES_Enc - DEBUG - {'col_0': 'UID', 'col_1': 'RIDAGEYR', 'col_2': 'RIAGENDR', 'col_3': 'RIDRETH1', 'col_4': 'DMDCITZN'}
2024/08/22 08:24:02 - AES_Enc - DEBUG - ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 08:24:02 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 08:24:02 - AES_Enc - DEBUG -  readFrom_csv OK
2024/08/22 08:24:02 - AES_Enc - DEBUG - ============start2======================
2024/08/22 08:24:02 - AES_Enc - DEBUG - ###################out udfMac table name
2024/08/22 08:24:02 - AES_Enc - DEBUG - citc____P1
2024/08/22 08:24:02 - AES_Enc - DEBUG - ###################sc.applicationId
2024/08/22 08:24:02 - AES_Enc - DEBUG - citc____application_1724314517462_0002
2024/08/22 08:24:04 - AES_Enc - DEBUG - ---++++--cols: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 08:24:04 - AES_Enc - DEBUG - ---++++--AES key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:24:04 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/08/22 08:24:04 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/08/22 08:24:04 - AES_Enc - DEBUG - ---++++--MAC key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:24:04 - AES_Enc - DEBUG - enter
2024/08/22 08:24:04 - AES_Enc - DEBUG - enter
2024/08/22 08:24:04 - AES_Enc - DEBUG - in udfMacCols
2024/08/22 08:24:04 - AES_Enc - DEBUG - col finishy
2024/08/22 08:24:04 - AES_Enc - DEBUG - AES and MAC = ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN'] []
2024/08/22 08:24:04 - AES_Enc - DEBUG - col name before
2024/08/22 08:24:04 - AES_Enc - DEBUG - MAC_KEY = 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 08:24:04 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 08:24:04 - AES_Enc - DEBUG - before extend
2024/08/22 08:24:04 - AES_Enc - DEBUG - ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 08:24:04 - AES_Enc - DEBUG - before tmpList
2024/08/22 08:24:04 - AES_Enc - DEBUG - after tmpList
2024/08/22 08:24:04 - AES_Enc - DEBUG - <class 'pyspark.sql.utils.AnalysisException'>
2024/08/22 08:24:04 - AES_Enc - DEBUG - "cannot resolve '`UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN`' given input columns: [df_table__.col_0, df_table__.col_4, df_table__.col_1, df_table__.col_3, df_table__.col_2];;\n'Project ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN, 'UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN__]\n+- AnalysisBarrier\n      +- Project [col_0#26, col_1#27, col_2#28, col_3#29, col_4#30]\n         +- SubqueryAlias df_table__\n            +- Project [UID#10 AS col_0#26, RIDAGEYR#11 AS col_1#27, RIAGENDR#12 AS col_2#28, RIDRETH1#13 AS col_3#29, DMDCITZN#14 AS col_4#30]\n               +- Relation[UID#10,RIDAGEYR#11,RIAGENDR#12,RIDRETH1#13,DMDCITZN#14] csv\n"
2024/08/22 08:24:04 - AES_Enc - DEBUG - <traceback object at 0x7a10ac3fbe08>
2024/08/22 08:24:04 - AES_Enc - DEBUG - 3
2024/08/22 08:24:04 - AES_Enc - DEBUG - errTable_err_udfEncCols()
2024/08/22 09:04:58 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 09:04:58 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 09:04:58 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 09:04:58 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 09:04:58 - AES_Enc - DEBUG - AES_columns_mac:UID
2024/08/22 09:04:58 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 09:04:58 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 09:04:58 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 09:04:58 - AES_Enc - DEBUG - spark_import_service_ip_130.211.246.188
2024/08/22 09:04:58 - AES_Enc - DEBUG - project_cert = eyJncm91cF90eXBlIjoic3lzIiwiZW5jX2tleSI6Ijk1RUFGOTFEOTAxRThCMUM4REQ2M0U3Q0FEOTA0NDY4Q0VBMTcwREZDRDY4Q0IxQzgxNUQ5NDYwM0JCRUU5QTkiLCJwcm9qZWN0X25hbWUiOiJ0ZXN0MDgyMjEiLCJwcm9qZWN0X2ZvbGRlciI6InRlc3QwODIyMSIsInBldHNfc2VydmljZV9pcCI6InBlZHNhcy5tb2RhLmdvdi50dyJ9
2024/08/22 09:04:58 - AES_Enc - DEBUG - group_type = sys
2024/08/22 09:04:58 - AES_Enc - DEBUG - Mac_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:04:58 - AES_Enc - DEBUG - AES_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:04:58 - AES_Enc - DEBUG - AES key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:04:58 - AES_Enc - DEBUG - Mac key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:04:58 - AES_Enc - DEBUG - projName: test08221
2024/08/22 09:04:58 - AES_Enc - DEBUG - project_folder: test08221
2024/08/22 09:04:58 - AES_Enc - DEBUG - pets_service_ip : pedsas.moda.gov.tw
2024/08/22 09:04:58 - AES_Enc - DEBUG - AES password ok
2024/08/22 09:04:58 - AES_Enc - DEBUG - Mac password ok
2024/08/22 09:04:58 - AES_Enc - DEBUG - AES columns name will be maced: ['UID']
2024/08/22 09:04:58 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 09:05:13 - AES_Enc - DEBUG - cmd is echo "citcw200@" | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:05:13 - AES_Enc - DEBUG - run result is 0
2024/08/22 09:05:13 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:05:13 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/08/22 09:05:13 - AES_Enc - DEBUG - ============start======================
2024/08/22 09:05:13 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:05:13 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 09:05:13 - AES_Enc - DEBUG - AES columns name will be maced: ['UID']
2024/08/22 09:05:13 - AES_Enc - DEBUG - remove hdfs_path = /tmp/P1.csv
2024/08/22 09:05:14 - AES_Enc - DEBUG - remove hdfs file result = b'24/08/22 09:05:14 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n',b'24/08/22 09:05:14 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.\n'
2024/08/22 09:05:14 - AES_Enc - DEBUG -  AAAAAAAAAA-P1.csv exist before , rm ok
2024/08/22 09:05:14 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/08/22 09:05:14 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:05:14 - AES_Enc - DEBUG - sep: ,
2024/08/22 09:05:14 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/P1.csv
2024/08/22 09:05:16 - AES_Enc - DEBUG - BBBBresult = b'24/08/22 09:05:15 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n'
2024/08/22 09:05:16 - AES_Enc - DEBUG - In readLocalData
2024/08/22 09:05:20 - AES_Enc - DEBUG - header valuse = ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 09:05:22 - AES_Enc - DEBUG - In checkListQuotes header
2024/08/22 09:05:22 - AES_Enc - DEBUG - In checkListQuotes record
2024/08/22 09:05:22 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/08/22 09:05:22 - AES_Enc - DEBUG - {'col_0': 'UID', 'col_1': 'RIDAGEYR', 'col_2': 'RIAGENDR', 'col_3': 'RIDRETH1', 'col_4': 'DMDCITZN'}
2024/08/22 09:05:22 - AES_Enc - DEBUG - ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 09:05:22 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:05:22 - AES_Enc - DEBUG -  readFrom_csv OK
2024/08/22 09:05:22 - AES_Enc - DEBUG - ============start2======================
2024/08/22 09:05:22 - AES_Enc - DEBUG - ###################out udfMac table name
2024/08/22 09:05:22 - AES_Enc - DEBUG - citc____P1
2024/08/22 09:05:22 - AES_Enc - DEBUG - ###################sc.applicationId
2024/08/22 09:05:22 - AES_Enc - DEBUG - citc____application_1724314517462_0003
2024/08/22 09:05:22 - AES_Enc - DEBUG - ---++++--cols: ['col_0']
2024/08/22 09:05:22 - AES_Enc - DEBUG - ---++++--AES key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:05:22 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/08/22 09:05:22 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/08/22 09:05:22 - AES_Enc - DEBUG - ---++++--MAC key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:05:22 - AES_Enc - DEBUG - enter
2024/08/22 09:05:22 - AES_Enc - DEBUG - enter
2024/08/22 09:05:22 - AES_Enc - DEBUG - in udfMacCols
2024/08/22 09:05:22 - AES_Enc - DEBUG - col finishy
2024/08/22 09:05:22 - AES_Enc - DEBUG - AES and MAC = ['col_0'] []
2024/08/22 09:05:22 - AES_Enc - DEBUG - col name before
2024/08/22 09:05:22 - AES_Enc - DEBUG - MAC_KEY = 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:05:23 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:05:23 - AES_Enc - DEBUG - before extend
2024/08/22 09:05:23 - AES_Enc - DEBUG - ['col_0']
2024/08/22 09:05:23 - AES_Enc - DEBUG - before tmpList
2024/08/22 09:05:23 - AES_Enc - DEBUG - after tmpList
2024/08/22 09:05:23 - AES_Enc - DEBUG - finish
2024/08/22 09:05:23 - AES_Enc - DEBUG - ---2--dataHash: Y
2024/08/22 09:05:23 - AES_Enc - DEBUG - ---2--onlyHash: Y
2024/08/22 09:05:23 - AES_Enc - DEBUG - ---33333--tableName_: sys_P1
2024/08/22 09:05:23 - AES_Enc - DEBUG - Output path: /home/hadoop/proj_/dataMac/output
2024/08/22 09:05:23 - AES_Enc - DEBUG - header : ['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:05:29 - AES_Enc - DEBUG - export data succeed.
2024/08/22 09:05:29 - AES_Enc - DEBUG - column name: UID
2024/08/22 09:05:30 - AES_Enc - DEBUG - anormal count: 10000 normal count: 0 total count: 10000
2024/08/22 09:05:30 - AES_Enc - DEBUG - out_json: {'enc_key': '95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9,95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9', 'col_name': 'UID,RIDAGEYR,RIAGENDR,RIDRETH1,DMDCITZN', 'col_setting': 'AES,No_setting,No_setting,No_setting,No_setting', 'enc_datasetname': 'sys_P1.csv', 'ds_count': '10000'}
2024/08/22 09:05:30 - AES_Enc - DEBUG - ============end=======================/home/hadoop/proj_/dataMac/output/test08221
2024/08/22 09:05:30 - AES_Enc - DEBUG - remove hdfs_path = /tmp/P1.csv
2024/08/22 09:05:31 - AES_Enc - DEBUG - remove hdfs file result = b'24/08/22 09:05:30 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n',b'24/08/22 09:05:31 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.\n'
2024/08/22 09:05:31 - AES_Enc - DEBUG -  AAAAAAAAAA-P1.csv rm ok
2024/08/22 09:05:31 - AES_Enc - DEBUG - itri-pedsa
2024/08/22 09:05:31 - AES_Enc - DEBUG - /home/itri-pedsa/deploy_PEDSA_mohw/mohw0820/PETS/pets_service/sftp_upload_folder
2024/08/22 09:05:31 - AES_Enc - DEBUG - %%%%%%%%%%%%%%%%%%
2024/08/22 09:05:31 - AES_Enc - DEBUG - ============cmd_send=======================
2024/08/22 09:05:31 - AES_Enc - DEBUG - cmd_send:scp -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem -P 22 -r /home/hadoop/proj_/dataMac/output/test08221 itri-pedsa@pedsas.moda.gov.tw:/home/itri-pedsa/deploy_PEDSA_mohw/mohw0820/PETS/pets_service/sftp_upload_folder
2024/08/22 09:05:31 - AES_Enc - DEBUG - mod_str:chmod 755 /home/itri-pedsa/deploy_PEDSA_mohw/mohw0820/PETS/pets_service/sftp_upload_folder/test08221
2024/08/22 09:05:31 - AES_Enc - DEBUG - ============ cmd_chmod =======================
2024/08/22 09:05:31 - AES_Enc - DEBUG - cmd_chmod:ssh -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem itri-pedsa@pedsas.moda.gov.tw 'chmod 755 /home/itri-pedsa/deploy_PEDSA_mohw/mohw0820/PETS/pets_service/sftp_upload_folder/test08221'
2024/08/22 09:06:08 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 09:06:08 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 09:06:08 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 09:06:08 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 09:06:08 - AES_Enc - DEBUG - AES_columns_mac:UID
2024/08/22 09:06:08 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 09:06:08 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 09:06:08 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 09:06:08 - AES_Enc - DEBUG - spark_import_service_ip_130.211.246.188
2024/08/22 09:06:08 - AES_Enc - DEBUG - project_cert = eyJncm91cF90eXBlIjoic3lzIiwiZW5jX2tleSI6Ijk1RUFGOTFEOTAxRThCMUM4REQ2M0U3Q0FEOTA0NDY4Q0VBMTcwREZDRDY4Q0IxQzgxNUQ5NDYwM0JCRUU5QTkiLCJwcm9qZWN0X25hbWUiOiJ0ZXN0MDgyMjEiLCJwcm9qZWN0X2ZvbGRlciI6InRlc3QwODIyMSIsInBldHNfc2VydmljZV9pcCI6InBlZHNhcy5tb2RhLmdvdi50dyJ9
2024/08/22 09:06:08 - AES_Enc - DEBUG - group_type = sys
2024/08/22 09:06:08 - AES_Enc - DEBUG - Mac_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:06:08 - AES_Enc - DEBUG - AES_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:06:08 - AES_Enc - DEBUG - AES key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:06:08 - AES_Enc - DEBUG - Mac key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:06:08 - AES_Enc - DEBUG - projName: test08221
2024/08/22 09:06:08 - AES_Enc - DEBUG - project_folder: test08221
2024/08/22 09:06:08 - AES_Enc - DEBUG - pets_service_ip : pedsas.moda.gov.tw
2024/08/22 09:06:08 - AES_Enc - DEBUG - AES password ok
2024/08/22 09:06:08 - AES_Enc - DEBUG - Mac password ok
2024/08/22 09:06:08 - AES_Enc - DEBUG - AES columns name will be maced: ['UID']
2024/08/22 09:06:08 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 09:06:22 - AES_Enc - DEBUG - cmd is echo "citcw200@" | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:06:22 - AES_Enc - DEBUG - run result is 0
2024/08/22 09:06:22 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:06:22 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/08/22 09:06:22 - AES_Enc - DEBUG - ============start======================
2024/08/22 09:06:22 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:06:22 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 09:06:22 - AES_Enc - DEBUG - AES columns name will be maced: ['UID']
2024/08/22 09:06:22 - AES_Enc - DEBUG - remove hdfs_path = /tmp/P1.csv
2024/08/22 09:06:23 - AES_Enc - DEBUG - remove hdfs file result = b'24/08/22 09:06:23 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n'
2024/08/22 09:06:23 - AES_Enc - DEBUG -  AAAAAAAAAA-P1.csv exist before , rm ok
2024/08/22 09:06:23 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/08/22 09:06:23 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:06:23 - AES_Enc - DEBUG - sep: ,
2024/08/22 09:06:23 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/P1.csv
2024/08/22 09:06:25 - AES_Enc - DEBUG - BBBBresult = b'24/08/22 09:06:24 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n'
2024/08/22 09:06:25 - AES_Enc - DEBUG - In readLocalData
2024/08/22 09:06:29 - AES_Enc - DEBUG - header valuse = ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 09:06:29 - AES_Enc - DEBUG - In checkListQuotes header
2024/08/22 09:06:29 - AES_Enc - DEBUG - In checkListQuotes record
2024/08/22 09:06:29 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/08/22 09:06:29 - AES_Enc - DEBUG - {'col_0': 'UID', 'col_1': 'RIDAGEYR', 'col_2': 'RIAGENDR', 'col_3': 'RIDRETH1', 'col_4': 'DMDCITZN'}
2024/08/22 09:06:29 - AES_Enc - DEBUG - ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 09:06:29 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:06:29 - AES_Enc - DEBUG -  readFrom_csv OK
2024/08/22 09:06:29 - AES_Enc - DEBUG - ============start2======================
2024/08/22 09:06:29 - AES_Enc - DEBUG - ###################out udfMac table name
2024/08/22 09:06:29 - AES_Enc - DEBUG - citc____P1
2024/08/22 09:06:29 - AES_Enc - DEBUG - ###################sc.applicationId
2024/08/22 09:06:29 - AES_Enc - DEBUG - citc____application_1724314517462_0004
2024/08/22 09:06:31 - AES_Enc - DEBUG - ---++++--cols: ['col_0']
2024/08/22 09:06:31 - AES_Enc - DEBUG - ---++++--AES key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:06:31 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/08/22 09:06:31 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/08/22 09:06:31 - AES_Enc - DEBUG - ---++++--MAC key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:06:31 - AES_Enc - DEBUG - enter
2024/08/22 09:06:31 - AES_Enc - DEBUG - enter
2024/08/22 09:06:31 - AES_Enc - DEBUG - in udfMacCols
2024/08/22 09:06:31 - AES_Enc - DEBUG - col finishy
2024/08/22 09:06:31 - AES_Enc - DEBUG - AES and MAC = ['col_0'] []
2024/08/22 09:06:31 - AES_Enc - DEBUG - col name before
2024/08/22 09:06:31 - AES_Enc - DEBUG - MAC_KEY = 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:06:32 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:06:32 - AES_Enc - DEBUG - before extend
2024/08/22 09:06:32 - AES_Enc - DEBUG - ['col_0']
2024/08/22 09:06:32 - AES_Enc - DEBUG - before tmpList
2024/08/22 09:06:32 - AES_Enc - DEBUG - after tmpList
2024/08/22 09:06:32 - AES_Enc - DEBUG - finish
2024/08/22 09:06:32 - AES_Enc - DEBUG - ---2--dataHash: Y
2024/08/22 09:06:32 - AES_Enc - DEBUG - ---2--onlyHash: Y
2024/08/22 09:06:32 - AES_Enc - DEBUG - ---33333--tableName_: sys_P1
2024/08/22 09:06:32 - AES_Enc - DEBUG - Output path: /home/hadoop/proj_/dataMac/output
2024/08/22 09:06:32 - AES_Enc - DEBUG - header : ['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:06:38 - AES_Enc - DEBUG - export data succeed.
2024/08/22 09:06:38 - AES_Enc - DEBUG - column name: UID
2024/08/22 09:06:39 - AES_Enc - DEBUG - anormal count: 10000 normal count: 0 total count: 10000
2024/08/22 09:06:39 - AES_Enc - DEBUG - out_json: {'enc_key': '95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9,95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9', 'col_name': 'UID,RIDAGEYR,RIAGENDR,RIDRETH1,DMDCITZN', 'col_setting': 'AES,No_setting,No_setting,No_setting,No_setting', 'enc_datasetname': 'sys_P1.csv', 'ds_count': '10000'}
2024/08/22 09:06:39 - AES_Enc - DEBUG - ============end=======================/home/hadoop/proj_/dataMac/output/test08221
2024/08/22 09:06:39 - AES_Enc - DEBUG - remove hdfs_path = /tmp/P1.csv
2024/08/22 09:06:41 - AES_Enc - DEBUG - remove hdfs file result = b'24/08/22 09:06:40 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n',b'24/08/22 09:06:41 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.\n'
2024/08/22 09:06:41 - AES_Enc - DEBUG -  AAAAAAAAAA-P1.csv rm ok
2024/08/22 09:06:41 - AES_Enc - DEBUG - itri-pedsa
2024/08/22 09:06:41 - AES_Enc - DEBUG - /home/itri-pedsa/deploy_PEDSA_mohw/mohw0820/PETS/pets_service/sftp_upload_folder
2024/08/22 09:06:41 - AES_Enc - DEBUG - %%%%%%%%%%%%%%%%%%
2024/08/22 09:06:41 - AES_Enc - DEBUG - ============cmd_send=======================
2024/08/22 09:06:41 - AES_Enc - DEBUG - cmd_send:scp -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem -P 22 -r /home/hadoop/proj_/dataMac/output/test08221 itri-pedsa@pedsas.moda.gov.tw:/home/itri-pedsa/deploy_PEDSA_mohw/mohw0820/PETS/pets_service/sftp_upload_folder
2024/08/22 09:06:41 - AES_Enc - DEBUG - mod_str:chmod 755 /home/itri-pedsa/deploy_PEDSA_mohw/mohw0820/PETS/pets_service/sftp_upload_folder/test08221
2024/08/22 09:06:41 - AES_Enc - DEBUG - ============ cmd_chmod =======================
2024/08/22 09:06:41 - AES_Enc - DEBUG - cmd_chmod:ssh -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem itri-pedsa@pedsas.moda.gov.tw 'chmod 755 /home/itri-pedsa/deploy_PEDSA_mohw/mohw0820/PETS/pets_service/sftp_upload_folder/test08221'
2024/08/22 09:54:43 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 09:54:43 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 09:54:43 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 09:54:43 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 09:54:43 - AES_Enc - DEBUG - AES_columns_mac:UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN
2024/08/22 09:54:43 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 09:54:43 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 09:54:43 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 09:54:43 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/08/22 09:54:43 - AES_Enc - DEBUG - project_cert = eyJncm91cF90eXBlIjoic3lzIiwiZW5jX2tleSI6Ijk1RUFGOTFEOTAxRThCMUM4REQ2M0U3Q0FEOTA0NDY4Q0VBMTcwREZDRDY4Q0IxQzgxNUQ5NDYwM0JCRUU5QTkiLCJwcm9qZWN0X25hbWUiOiJ0ZXN0MDgyMjEiLCJwcm9qZWN0X2ZvbGRlciI6InRlc3QwODIyMSIsInBldHNfc2VydmljZV9pcCI6InBlZHNhcy5tb2RhLmdvdi50dyJ9
2024/08/22 09:54:43 - AES_Enc - DEBUG - group_type = sys
2024/08/22 09:54:43 - AES_Enc - DEBUG - Mac_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:54:43 - AES_Enc - DEBUG - AES_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:54:43 - AES_Enc - DEBUG - AES key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:54:43 - AES_Enc - DEBUG - Mac key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:54:43 - AES_Enc - DEBUG - projName: test08221
2024/08/22 09:54:43 - AES_Enc - DEBUG - project_folder: test08221
2024/08/22 09:54:43 - AES_Enc - DEBUG - pets_service_ip : pedsas.moda.gov.tw
2024/08/22 09:54:43 - AES_Enc - DEBUG - AES password ok
2024/08/22 09:54:43 - AES_Enc - DEBUG - Mac password ok
2024/08/22 09:54:43 - AES_Enc - DEBUG - AES columns name will be maced: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 09:54:43 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 09:54:57 - AES_Enc - DEBUG - cmd is echo "citcw200@" | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:54:57 - AES_Enc - DEBUG - run result is 0
2024/08/22 09:54:57 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:54:57 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/08/22 09:54:57 - AES_Enc - DEBUG - ============start======================
2024/08/22 09:54:57 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:54:57 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 09:54:57 - AES_Enc - DEBUG - AES columns name will be maced: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 09:54:57 - AES_Enc - DEBUG - remove hdfs_path = /tmp/P1.csv
2024/08/22 09:54:59 - AES_Enc - DEBUG - remove hdfs file result = 
2024/08/22 09:54:59 - AES_Enc - DEBUG -  AAAAAAAAAA-P1.csv exist before , rm ok
2024/08/22 09:54:59 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/08/22 09:54:59 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:54:59 - AES_Enc - DEBUG - sep: ,
2024/08/22 09:54:59 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/P1.csv
2024/08/22 09:55:00 - AES_Enc - DEBUG - BBBBresult = 
2024/08/22 09:55:00 - AES_Enc - DEBUG - In readLocalData
2024/08/22 09:55:04 - AES_Enc - DEBUG - header valuse = ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 09:55:05 - AES_Enc - DEBUG - In checkListQuotes header
2024/08/22 09:55:05 - AES_Enc - DEBUG - In checkListQuotes record
2024/08/22 09:55:05 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/08/22 09:55:05 - AES_Enc - DEBUG - {'col_0': 'UID', 'col_1': 'RIDAGEYR', 'col_2': 'RIAGENDR', 'col_3': 'RIDRETH1', 'col_4': 'DMDCITZN'}
2024/08/22 09:55:05 - AES_Enc - DEBUG - ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 09:55:05 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:55:05 - AES_Enc - DEBUG -  readFrom_csv OK
2024/08/22 09:55:05 - AES_Enc - DEBUG - ============start2======================
2024/08/22 09:55:05 - AES_Enc - DEBUG - ###################out udfMac table name
2024/08/22 09:55:05 - AES_Enc - DEBUG - citc____P1
2024/08/22 09:55:05 - AES_Enc - DEBUG - ###################sc.applicationId
2024/08/22 09:55:05 - AES_Enc - DEBUG - citc____application_1724314517462_0005
2024/08/22 09:55:07 - AES_Enc - DEBUG - ---++++--cols: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 09:55:07 - AES_Enc - DEBUG - ---++++--AES key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:55:07 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/08/22 09:55:07 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/08/22 09:55:07 - AES_Enc - DEBUG - ---++++--MAC key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:55:07 - AES_Enc - DEBUG - enter
2024/08/22 09:55:07 - AES_Enc - DEBUG - enter
2024/08/22 09:55:07 - AES_Enc - DEBUG - in udfMacCols
2024/08/22 09:55:07 - AES_Enc - DEBUG - col finishy
2024/08/22 09:55:07 - AES_Enc - DEBUG - AES and MAC = ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN'] []
2024/08/22 09:55:07 - AES_Enc - DEBUG - col name before
2024/08/22 09:55:07 - AES_Enc - DEBUG - MAC_KEY = 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:55:07 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:55:07 - AES_Enc - DEBUG - before extend
2024/08/22 09:55:07 - AES_Enc - DEBUG - ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 09:55:07 - AES_Enc - DEBUG - before tmpList
2024/08/22 09:55:07 - AES_Enc - DEBUG - after tmpList
2024/08/22 09:55:07 - AES_Enc - DEBUG - <class 'pyspark.sql.utils.AnalysisException'>
2024/08/22 09:55:07 - AES_Enc - DEBUG - "cannot resolve '`UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN`' given input columns: [df_table__.col_1, df_table__.col_0, df_table__.col_3, df_table__.col_4, df_table__.col_2];;\n'Project ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN, 'UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN__]\n+- AnalysisBarrier\n      +- Project [col_0#26, col_1#27, col_2#28, col_3#29, col_4#30]\n         +- SubqueryAlias df_table__\n            +- Project [UID#10 AS col_0#26, RIDAGEYR#11 AS col_1#27, RIAGENDR#12 AS col_2#28, RIDRETH1#13 AS col_3#29, DMDCITZN#14 AS col_4#30]\n               +- Relation[UID#10,RIDAGEYR#11,RIAGENDR#12,RIDRETH1#13,DMDCITZN#14] csv\n"
2024/08/22 09:55:07 - AES_Enc - DEBUG - <traceback object at 0x7364adc8de08>
2024/08/22 09:55:07 - AES_Enc - DEBUG - 3
2024/08/22 09:55:07 - AES_Enc - DEBUG - errTable_err_udfEncCols()
2024/08/22 09:57:05 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 09:57:05 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 09:57:05 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 09:57:05 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 09:57:05 - AES_Enc - DEBUG - AES_columns_mac:UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN
2024/08/22 09:57:05 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 09:57:05 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 09:57:05 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 09:57:05 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/08/22 09:57:05 - AES_Enc - DEBUG - project_cert = eyJncm91cF90eXBlIjoic3lzIiwiZW5jX2tleSI6Ijk1RUFGOTFEOTAxRThCMUM4REQ2M0U3Q0FEOTA0NDY4Q0VBMTcwREZDRDY4Q0IxQzgxNUQ5NDYwM0JCRUU5QTkiLCJwcm9qZWN0X25hbWUiOiJ0ZXN0MDgyMjEiLCJwcm9qZWN0X2ZvbGRlciI6InRlc3QwODIyMSIsInBldHNfc2VydmljZV9pcCI6InBlZHNhcy5tb2RhLmdvdi50dyJ9
2024/08/22 09:57:05 - AES_Enc - DEBUG - group_type = sys
2024/08/22 09:57:05 - AES_Enc - DEBUG - Mac_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:57:05 - AES_Enc - DEBUG - AES_hashkey:95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:57:05 - AES_Enc - DEBUG - AES key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:57:05 - AES_Enc - DEBUG - Mac key : 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:57:05 - AES_Enc - DEBUG - projName: test08221
2024/08/22 09:57:05 - AES_Enc - DEBUG - project_folder: test08221
2024/08/22 09:57:05 - AES_Enc - DEBUG - pets_service_ip : pedsas.moda.gov.tw
2024/08/22 09:57:05 - AES_Enc - DEBUG - AES password ok
2024/08/22 09:57:05 - AES_Enc - DEBUG - Mac password ok
2024/08/22 09:57:05 - AES_Enc - DEBUG - AES columns name will be maced: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 09:57:05 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 09:57:20 - AES_Enc - DEBUG - cmd is echo "citcw200@" | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:57:20 - AES_Enc - DEBUG - run result is 0
2024/08/22 09:57:20 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:57:20 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/08/22 09:57:20 - AES_Enc - DEBUG - ============start======================
2024/08/22 09:57:20 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:57:20 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/08/22 09:57:20 - AES_Enc - DEBUG - AES columns name will be maced: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 09:57:20 - AES_Enc - DEBUG - remove hdfs_path = /tmp/P1.csv
2024/08/22 09:57:22 - AES_Enc - DEBUG - remove hdfs file result = b'24/08/22 09:57:21 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.\n'
2024/08/22 09:57:22 - AES_Enc - DEBUG -  AAAAAAAAAA-P1.csv exist before , rm ok
2024/08/22 09:57:22 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/08/22 09:57:22 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/P1.csv
2024/08/22 09:57:22 - AES_Enc - DEBUG - sep: ,
2024/08/22 09:57:22 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/P1.csv
2024/08/22 09:57:24 - AES_Enc - DEBUG - BBBBresult = 
2024/08/22 09:57:24 - AES_Enc - DEBUG - In readLocalData
2024/08/22 09:57:28 - AES_Enc - DEBUG - header valuse = ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 09:57:30 - AES_Enc - DEBUG - In checkListQuotes header
2024/08/22 09:57:30 - AES_Enc - DEBUG - In checkListQuotes record
2024/08/22 09:57:30 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/08/22 09:57:30 - AES_Enc - DEBUG - {'col_0': 'UID', 'col_1': 'RIDAGEYR', 'col_2': 'RIAGENDR', 'col_3': 'RIDRETH1', 'col_4': 'DMDCITZN'}
2024/08/22 09:57:30 - AES_Enc - DEBUG - ['UID', 'RIDAGEYR', 'RIAGENDR', 'RIDRETH1', 'DMDCITZN']
2024/08/22 09:57:30 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:57:30 - AES_Enc - DEBUG -  readFrom_csv OK
2024/08/22 09:57:30 - AES_Enc - DEBUG - ============start2======================
2024/08/22 09:57:30 - AES_Enc - DEBUG - ###################out udfMac table name
2024/08/22 09:57:30 - AES_Enc - DEBUG - citc____P1
2024/08/22 09:57:30 - AES_Enc - DEBUG - ###################sc.applicationId
2024/08/22 09:57:30 - AES_Enc - DEBUG - citc____application_1724314517462_0006
2024/08/22 09:57:30 - AES_Enc - DEBUG - ---++++--cols: ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 09:57:30 - AES_Enc - DEBUG - ---++++--AES key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:57:30 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/08/22 09:57:30 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/08/22 09:57:30 - AES_Enc - DEBUG - ---++++--MAC key_: 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:57:30 - AES_Enc - DEBUG - enter
2024/08/22 09:57:30 - AES_Enc - DEBUG - enter
2024/08/22 09:57:30 - AES_Enc - DEBUG - in udfMacCols
2024/08/22 09:57:30 - AES_Enc - DEBUG - col finishy
2024/08/22 09:57:30 - AES_Enc - DEBUG - AES and MAC = ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN'] []
2024/08/22 09:57:30 - AES_Enc - DEBUG - col name before
2024/08/22 09:57:30 - AES_Enc - DEBUG - MAC_KEY = 95EAF91D901E8B1C8DD63E7CAD904468CEA170DFCD68CB1C815D94603BBEE9A9
2024/08/22 09:57:30 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4']
2024/08/22 09:57:30 - AES_Enc - DEBUG - before extend
2024/08/22 09:57:30 - AES_Enc - DEBUG - ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN']
2024/08/22 09:57:30 - AES_Enc - DEBUG - before tmpList
2024/08/22 09:57:30 - AES_Enc - DEBUG - after tmpList
2024/08/22 09:57:30 - AES_Enc - DEBUG - <class 'pyspark.sql.utils.AnalysisException'>
2024/08/22 09:57:30 - AES_Enc - DEBUG - "cannot resolve '`UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN`' given input columns: [df_table__.col_3, df_table__.col_2, df_table__.col_4, df_table__.col_0, df_table__.col_1];;\n'Project ['UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN, 'UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN__]\n+- AnalysisBarrier\n      +- Project [col_0#26, col_1#27, col_2#28, col_3#29, col_4#30]\n         +- SubqueryAlias df_table__\n            +- Project [UID#10 AS col_0#26, RIDAGEYR#11 AS col_1#27, RIAGENDR#12 AS col_2#28, RIDRETH1#13 AS col_3#29, DMDCITZN#14 AS col_4#30]\n               +- Relation[UID#10,RIDAGEYR#11,RIAGENDR#12,RIDRETH1#13,DMDCITZN#14] csv\n"
2024/08/22 09:57:30 - AES_Enc - DEBUG - <traceback object at 0x740168267048>
2024/08/22 09:57:30 - AES_Enc - DEBUG - 3
2024/08/22 09:57:30 - AES_Enc - DEBUG - errTable_err_udfEncCols()
2024/08/22 10:00:26 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/08/22 10:00:26 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/08/22 10:00:26 - AES_Enc - DEBUG - spark_import_projID_999
2024/08/22 10:00:26 - AES_Enc - DEBUG - MAC_columns_mac:
2024/08/22 10:00:26 - AES_Enc - DEBUG - AES_columns_mac:UID|RIDAGEYR|RIAGENDR|RIDRETH1|DMDCITZN
2024/08/22 10:00:26 - AES_Enc - DEBUG - onlyHash:Y
2024/08/22 10:00:26 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/08/22 10:00:26 - AES_Enc - DEBUG - spark_import_userId_1
2024/08/22 10:00:26 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/08/22 10:00:26 - AES_Enc - DEBUG - updateTProjectStatus error: __init__() should return None, not 'bool'
