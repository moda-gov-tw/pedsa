2024/10/17 08:51:09 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/10/17 08:51:09 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/10/17 08:51:09 - AES_Enc - DEBUG - spark_import_projID_999
2024/10/17 08:51:09 - AES_Enc - DEBUG - MAC_columns_mac:
2024/10/17 08:51:09 - AES_Enc - DEBUG - AES_columns_mac:SEQN
2024/10/17 08:51:09 - AES_Enc - DEBUG - onlyHash:Y
2024/10/17 08:51:09 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/10/17 08:51:09 - AES_Enc - DEBUG - spark_import_userId_1
2024/10/17 08:51:09 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/10/17 08:51:09 - AES_Enc - DEBUG - spark_import_identifier_ZDE0E
2024/10/17 08:51:09 - AES_Enc - DEBUG - project_cert = eyJwZXRzX3NlcnZpY2VfaXAiOiAiMzQuODEuMTE5LjQ5IiwgInByb2plY3RfbmFtZSI6ICJBNF9iXzEiLCAiZW5jX2tleSI6ICJGdkNFTjJmQUNTUFFjaDM1SFZwZ3VVTFp5QmVsYnBKVkZrNjRCNktjdXA4a2FORm1RRy8xWFBKN3diNG1EZHdBemRKTmRBRUkzNk1BUWpOalkxemVlQnN4L2xHdGNGZWgyMXFPR2xYV25MOUYxbDRzNWYrS3F2dWRUU1BZZ3Z4Uzl4VnFWbUcrc3ZDTG9mZEVrSURiRHkzeDg4OUJZM0hyWk9USWYvdERXSHowTWQwTGR3TjBmbXZBKzlxSmh5ZE82WWZFWmE5QUIrS2h6RmhyRGptMVl3aTJBRkFhaFVuWmptbGxIeTl3WDhoem55RWZIellVaEhZUUduQTNIa1MyeGc1cnNLMEZ2OFVVUVdBZUlmcjc3QWRXcHY4REgwOWNTdW5YWUg5UWZYaTdUdWZtRmlYS05OaXRVemE1dEQ2dUF2elNZclBaYWVkNi9rcHQzVkxSOUE9PSIsICJwcm9qZWN0X2ZvbGRlciI6ICJBNF9iXzEiLCAiZ3JvdXBfdHlwZSI6ICJzeXMifQ==
2024/10/17 08:51:09 - AES_Enc - DEBUG - group_type = sys
2024/10/17 08:51:09 - AES_Enc - DEBUG - Mac_hashkey:FvCEN2fACSPQch35HVpguULZyBelbpJVFk64B6Kcup8kaNFmQG/1XPJ7wb4mDdwAzdJNdAEI36MAQjNjY1zeeBsx/lGtcFeh21qOGlXWnL9F1l4s5f+KqvudTSPYgvxS9xVqVmG+svCLofdEkIDbDy3x889BY3HrZOTIf/tDWHz0Md0LdwN0fmvA+9qJhydO6YfEZa9AB+KhzFhrDjm1Ywi2AFAahUnZjmllHy9wX8hznyEfHzYUhHYQGnA3HkS2xg5rsK0Fv8UUQWAeIfr77AdWpv8DH09cSunXYH9QfXi7TufmFiXKNNitUza5tD6uAvzSYrPZaed6/kpt3VLR9A==
2024/10/17 08:51:09 - AES_Enc - DEBUG - AES_hashkey:FvCEN2fACSPQch35HVpguULZyBelbpJVFk64B6Kcup8kaNFmQG/1XPJ7wb4mDdwAzdJNdAEI36MAQjNjY1zeeBsx/lGtcFeh21qOGlXWnL9F1l4s5f+KqvudTSPYgvxS9xVqVmG+svCLofdEkIDbDy3x889BY3HrZOTIf/tDWHz0Md0LdwN0fmvA+9qJhydO6YfEZa9AB+KhzFhrDjm1Ywi2AFAahUnZjmllHy9wX8hznyEfHzYUhHYQGnA3HkS2xg5rsK0Fv8UUQWAeIfr77AdWpv8DH09cSunXYH9QfXi7TufmFiXKNNitUza5tD6uAvzSYrPZaed6/kpt3VLR9A==
2024/10/17 08:51:09 - AES_Enc - DEBUG - dec AES key : 81C5C370001B1BE88872F80F7A09AC79577C8BFA9CE017EF254443BFB93DFA9C
2024/10/17 08:51:09 - AES_Enc - DEBUG - dec Mac key : 81C5C370001B1BE88872F80F7A09AC79577C8BFA9CE017EF254443BFB93DFA9C
2024/10/17 08:51:09 - AES_Enc - DEBUG - projName: A4_b_1
2024/10/17 08:51:09 - AES_Enc - DEBUG - project_folder: A4_b_1
2024/10/17 08:51:09 - AES_Enc - DEBUG - pets_service_ip : 34.81.119.49
2024/10/17 08:51:09 - AES_Enc - DEBUG - AES password ok
2024/10/17 08:51:09 - AES_Enc - DEBUG - Mac password ok
2024/10/17 08:51:09 - AES_Enc - DEBUG - AES columns name will be maced: ['SEQN']
2024/10/17 08:51:09 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/10/17 08:51:23 - AES_Enc - DEBUG - cmd is echo citcw200@  | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/A4_c_1.csv
2024/10/17 08:51:23 - AES_Enc - DEBUG - run result is 0
2024/10/17 08:51:23 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/A4_c_1.csv
2024/10/17 08:51:23 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/10/17 08:51:23 - AES_Enc - DEBUG - ============start======================
2024/10/17 08:51:23 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/A4_c_1.csv
2024/10/17 08:51:23 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/10/17 08:51:23 - AES_Enc - DEBUG - AES columns name will be maced: ['SEQN']
2024/10/17 08:51:23 - AES_Enc - DEBUG - remove hdfs_path = /tmp/A4_c_1.csv
2024/10/17 08:51:25 - AES_Enc - DEBUG - remove hdfs file result = 
2024/10/17 08:51:25 - AES_Enc - DEBUG -  AAAAAAAAAA-A4_c_1.csv exist before , rm ok
2024/10/17 08:51:25 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/10/17 08:51:25 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/A4_c_1.csv
2024/10/17 08:51:25 - AES_Enc - DEBUG - sep: ,
2024/10/17 08:51:25 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/A4_c_1.csv
2024/10/17 08:51:27 - AES_Enc - DEBUG - BBBBresult = 
2024/10/17 08:51:27 - AES_Enc - DEBUG - In readLocalData
2024/10/17 08:51:31 - AES_Enc - DEBUG - header valuse = ['SEQN', 'RIDAGEYR', 'RIAGENDR', 'INDFMINC', 'DMDHHSIZ', 'ZCODE']
2024/10/17 08:51:32 - AES_Enc - DEBUG - In checkListQuotes header
2024/10/17 08:51:32 - AES_Enc - DEBUG - In checkListQuotes record
2024/10/17 08:51:32 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/10/17 08:51:32 - AES_Enc - DEBUG - {'col_0': 'SEQN', 'col_1': 'RIDAGEYR', 'col_2': 'RIAGENDR', 'col_3': 'INDFMINC', 'col_4': 'DMDHHSIZ', 'col_5': 'ZCODE'}
2024/10/17 08:51:32 - AES_Enc - DEBUG - ['SEQN', 'RIDAGEYR', 'RIAGENDR', 'INDFMINC', 'DMDHHSIZ', 'ZCODE']
2024/10/17 08:51:32 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5']
2024/10/17 08:51:32 - AES_Enc - DEBUG -  readFrom_csv OK
2024/10/17 08:51:32 - AES_Enc - DEBUG - ============start2======================
2024/10/17 08:51:32 - AES_Enc - DEBUG - ###################out udfMac table name
2024/10/17 08:51:32 - AES_Enc - DEBUG - citc____A4_c_1
2024/10/17 08:51:32 - AES_Enc - DEBUG - ###################sc.applicationId
2024/10/17 08:51:32 - AES_Enc - DEBUG - citc____application_1728441793834_0019
2024/10/17 08:51:33 - AES_Enc - DEBUG - ---++++--cols: ['col_0']
2024/10/17 08:51:33 - AES_Enc - DEBUG - ---++++--AES key_: 81C5C370001B1BE88872F80F7A09AC79577C8BFA9CE017EF254443BFB93DFA9C
2024/10/17 08:51:33 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/10/17 08:51:33 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/10/17 08:51:33 - AES_Enc - DEBUG - ---++++--MAC key_: 81C5C370001B1BE88872F80F7A09AC79577C8BFA9CE017EF254443BFB93DFA9C
2024/10/17 08:51:33 - AES_Enc - DEBUG - enter
2024/10/17 08:51:33 - AES_Enc - DEBUG - enter
2024/10/17 08:51:33 - AES_Enc - DEBUG - in udfMacCols
2024/10/17 08:51:33 - AES_Enc - DEBUG - col finishy
2024/10/17 08:51:33 - AES_Enc - DEBUG - AES and MAC = ['col_0'] []
2024/10/17 08:51:33 - AES_Enc - DEBUG - col name before
2024/10/17 08:51:33 - AES_Enc - DEBUG - MAC_KEY = 81C5C370001B1BE88872F80F7A09AC79577C8BFA9CE017EF254443BFB93DFA9C
2024/10/17 08:51:34 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5']
2024/10/17 08:51:34 - AES_Enc - DEBUG - before extend
2024/10/17 08:51:34 - AES_Enc - DEBUG - ['col_0']
2024/10/17 08:51:34 - AES_Enc - DEBUG - before tmpList
2024/10/17 08:51:34 - AES_Enc - DEBUG - after tmpList
2024/10/17 08:51:34 - AES_Enc - DEBUG - finish
2024/10/17 08:51:34 - AES_Enc - DEBUG - ---2--dataHash: Y
2024/10/17 08:51:34 - AES_Enc - DEBUG - ---2--onlyHash: Y
2024/10/17 08:51:34 - AES_Enc - DEBUG - ---33333--tableName_: sys_A4_c_1
2024/10/17 08:51:34 - AES_Enc - DEBUG - Output path: /home/hadoop/proj_/dataMac/output
2024/10/17 08:51:34 - AES_Enc - DEBUG - header : ['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5']
2024/10/17 08:51:50 - AES_Enc - DEBUG - export data succeed.
2024/10/17 08:51:50 - AES_Enc - DEBUG - column name: SEQN
2024/10/17 08:51:57 - AES_Enc - DEBUG - anormal count: 1000000 normal count: 0 total count: 1000000
2024/10/17 08:51:57 - AES_Enc - DEBUG - out_json: {'enc_key': '81C5C370001B1BE88872F80F7A09AC79577C8BFA9CE017EF254443BFB93DFA9C,81C5C370001B1BE88872F80F7A09AC79577C8BFA9CE017EF254443BFB93DFA9C', 'col_name': 'SEQN,RIDAGEYR,RIAGENDR,INDFMINC,DMDHHSIZ,ZCODE', 'col_setting': 'AES,No_setting,No_setting,No_setting,No_setting,No_setting', 'enc_datasetname': 'sys_A4_c_1.csv', 'ds_count': '1000000'}
2024/10/17 08:51:57 - AES_Enc - DEBUG - ============end=======================/home/hadoop/proj_/dataMac/output/A4_b_1
2024/10/17 08:51:57 - AES_Enc - DEBUG - remove hdfs_path = /tmp/A4_c_1.csv
2024/10/17 08:51:59 - AES_Enc - DEBUG - remove hdfs file result = b'24/10/17 08:51:58 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.\n'
2024/10/17 08:51:59 - AES_Enc - DEBUG -  AAAAAAAAAA-A4_c_1.csv rm ok
2024/10/17 08:51:59 - AES_Enc - DEBUG - itri-pedsa
2024/10/17 08:51:59 - AES_Enc - DEBUG - /home/itri-pedsa/deploy_PEDSA/pedsa_s/pets_service/sftp_upload_folder
2024/10/17 08:51:59 - AES_Enc - DEBUG - %%%%%%%%%%%%%%%%%%
2024/10/17 08:51:59 - AES_Enc - DEBUG - ============cmd_send=======================
2024/10/17 08:51:59 - AES_Enc - DEBUG - cmd_send:scp -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem -P 22 -r /home/hadoop/proj_/dataMac/output/A4_b_1 itri-pedsa@34.81.119.49:/home/itri-pedsa/deploy_PEDSA/pedsa_s/pets_service/sftp_upload_folder
2024/10/17 08:52:00 - AES_Enc - DEBUG - b''
2024/10/17 08:52:00 - AES_Enc - DEBUG - b"Warning: Permanently added '34.81.119.49' (ED25519) to the list of known hosts.\r\n"
2024/10/17 08:52:00 - AES_Enc - DEBUG - ============AES_Enc end=======================
2024/10/17 08:52:00 - AES_Enc - DEBUG - insert T_Pets_ProjectStatus fail: errTable: Insert to PetsService.T_Pets_ProjectStatus fail: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`PetsService`.`T_Pets_ProjectStatus`, CONSTRAINT `T_Pets_ProjectStatus_ibfk_1` FOREIGN KEY (`project_id`) REFERENCES `T_Pets_Project` (`project_id`))')
