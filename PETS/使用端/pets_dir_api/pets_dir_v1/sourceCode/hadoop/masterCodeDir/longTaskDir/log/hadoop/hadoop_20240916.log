2024/09/16 05:52:31 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/09/16 05:52:31 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/09/16 05:52:31 - AES_Enc - DEBUG - spark_import_projID_999
2024/09/16 05:52:31 - AES_Enc - DEBUG - MAC_columns_mac:
2024/09/16 05:52:31 - AES_Enc - DEBUG - AES_columns_mac:SEQN
2024/09/16 05:52:31 - AES_Enc - DEBUG - onlyHash:Y
2024/09/16 05:52:31 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/09/16 05:52:31 - AES_Enc - DEBUG - spark_import_userId_1
2024/09/16 05:52:31 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/09/16 05:52:31 - AES_Enc - DEBUG - project_cert = eyJncm91cF90eXBlIjoic3lzIiwiZW5jX2tleSI6IjU4OERCOTQwOTc0RTc0NTk1MkYwRDBCQzg1RUQyREVBQkUxNzZEM0U4RUQ1OUU5NjEzNzVDMTAxOEVCOEM2RDUiLCJwcm9qZWN0X25hbWUiOiJBMV90ZWxjb19rXzUiLCJwcm9qZWN0X2ZvbGRlciI6IkExX3RlbGNvX2tfNSIsInBldHNfc2VydmljZV9pcCI6InBlZHNhcy5tb2RhLmdvdi50dyJ9
2024/09/16 05:52:31 - AES_Enc - DEBUG - group_type = sys
2024/09/16 05:52:31 - AES_Enc - DEBUG - Mac_hashkey:588DB940974E745952F0D0BC85ED2DEABE176D3E8ED59E961375C1018EB8C6D5
2024/09/16 05:52:31 - AES_Enc - DEBUG - AES_hashkey:588DB940974E745952F0D0BC85ED2DEABE176D3E8ED59E961375C1018EB8C6D5
2024/09/16 05:52:31 - AES_Enc - DEBUG - AES key : 588DB940974E745952F0D0BC85ED2DEABE176D3E8ED59E961375C1018EB8C6D5
2024/09/16 05:52:31 - AES_Enc - DEBUG - Mac key : 588DB940974E745952F0D0BC85ED2DEABE176D3E8ED59E961375C1018EB8C6D5
2024/09/16 05:52:31 - AES_Enc - DEBUG - projName: A1_telco_k_5
2024/09/16 05:52:31 - AES_Enc - DEBUG - project_folder: A1_telco_k_5
2024/09/16 05:52:31 - AES_Enc - DEBUG - pets_service_ip : pedsas.moda.gov.tw
2024/09/16 05:52:31 - AES_Enc - DEBUG - AES password ok
2024/09/16 05:52:31 - AES_Enc - DEBUG - Mac password ok
2024/09/16 05:52:31 - AES_Enc - DEBUG - AES columns name will be maced: ['SEQN']
2024/09/16 05:52:31 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/09/16 05:52:45 - AES_Enc - DEBUG - cmd is echo "citcw200@" | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 05:52:45 - AES_Enc - DEBUG - run result is 0
2024/09/16 05:52:45 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 05:52:45 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/09/16 05:52:45 - AES_Enc - DEBUG - ============start======================
2024/09/16 05:52:45 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 05:52:45 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/09/16 05:52:45 - AES_Enc - DEBUG - AES columns name will be maced: ['SEQN']
2024/09/16 05:52:45 - AES_Enc - DEBUG - remove hdfs_path = /tmp/telco.csv
2024/09/16 05:52:47 - AES_Enc - DEBUG - remove hdfs file result = 
2024/09/16 05:52:47 - AES_Enc - DEBUG -  AAAAAAAAAA-telco.csv exist before , rm ok
2024/09/16 05:52:47 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/09/16 05:52:47 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 05:52:47 - AES_Enc - DEBUG - sep: ,
2024/09/16 05:52:47 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/telco.csv
2024/09/16 05:52:48 - AES_Enc - DEBUG - BBBBresult = 
2024/09/16 05:52:48 - AES_Enc - DEBUG - In readLocalData
2024/09/16 05:52:55 - AES_Enc - DEBUG - header valuse = ['customerID', 'gender', 'SeniorCitizen', 'Partner', 'Dependents', 'tenure', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'Churn', 'SEQN']
2024/09/16 05:52:56 - AES_Enc - DEBUG - In checkListQuotes header
2024/09/16 05:52:56 - AES_Enc - DEBUG - In checkListQuotes record
2024/09/16 05:52:56 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/09/16 05:52:56 - AES_Enc - DEBUG - {'col_0': 'customerID', 'col_1': 'gender', 'col_2': 'SeniorCitizen', 'col_3': 'Partner', 'col_4': 'Dependents', 'col_5': 'tenure', 'col_6': 'PhoneService', 'col_7': 'MultipleLines', 'col_8': 'InternetService', 'col_9': 'OnlineSecurity', 'col_10': 'OnlineBackup', 'col_11': 'DeviceProtection', 'col_12': 'TechSupport', 'col_13': 'StreamingTV', 'col_14': 'StreamingMovies', 'col_15': 'Contract', 'col_16': 'PaperlessBilling', 'col_17': 'PaymentMethod', 'col_18': 'MonthlyCharges', 'col_19': 'TotalCharges', 'col_20': 'Churn', 'col_21': 'SEQN'}
2024/09/16 05:52:56 - AES_Enc - DEBUG - ['customerID', 'gender', 'SeniorCitizen', 'Partner', 'Dependents', 'tenure', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'Churn', 'SEQN']
2024/09/16 05:52:56 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5', 'col_6', 'col_7', 'col_8', 'col_9', 'col_10', 'col_11', 'col_12', 'col_13', 'col_14', 'col_15', 'col_16', 'col_17', 'col_18', 'col_19', 'col_20', 'col_21']
2024/09/16 05:52:56 - AES_Enc - DEBUG -  readFrom_csv OK
2024/09/16 05:52:56 - AES_Enc - DEBUG - ============start2======================
2024/09/16 05:52:56 - AES_Enc - DEBUG - ###################out udfMac table name
2024/09/16 05:52:56 - AES_Enc - DEBUG - citc____telco
2024/09/16 05:52:56 - AES_Enc - DEBUG - ###################sc.applicationId
2024/09/16 05:52:56 - AES_Enc - DEBUG - citc____application_1724401035269_0021
2024/09/16 05:52:57 - AES_Enc - DEBUG - ---++++--cols: ['col_21']
2024/09/16 05:52:57 - AES_Enc - DEBUG - ---++++--AES key_: 588DB940974E745952F0D0BC85ED2DEABE176D3E8ED59E961375C1018EB8C6D5
2024/09/16 05:52:57 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/09/16 05:52:57 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/09/16 05:52:57 - AES_Enc - DEBUG - ---++++--MAC key_: 588DB940974E745952F0D0BC85ED2DEABE176D3E8ED59E961375C1018EB8C6D5
2024/09/16 05:52:57 - AES_Enc - DEBUG - enter
2024/09/16 05:52:57 - AES_Enc - DEBUG - enter
2024/09/16 05:52:57 - AES_Enc - DEBUG - in udfMacCols
2024/09/16 05:52:57 - AES_Enc - DEBUG - col finishy
2024/09/16 05:52:57 - AES_Enc - DEBUG - AES and MAC = ['col_21'] []
2024/09/16 05:52:57 - AES_Enc - DEBUG - col name before
2024/09/16 05:52:57 - AES_Enc - DEBUG - MAC_KEY = 588DB940974E745952F0D0BC85ED2DEABE176D3E8ED59E961375C1018EB8C6D5
2024/09/16 05:52:57 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5', 'col_6', 'col_7', 'col_8', 'col_9', 'col_10', 'col_11', 'col_12', 'col_13', 'col_14', 'col_15', 'col_16', 'col_17', 'col_18', 'col_19', 'col_20', 'col_21']
2024/09/16 05:52:57 - AES_Enc - DEBUG - before extend
2024/09/16 05:52:57 - AES_Enc - DEBUG - ['col_21']
2024/09/16 05:52:57 - AES_Enc - DEBUG - before tmpList
2024/09/16 05:52:57 - AES_Enc - DEBUG - after tmpList
2024/09/16 05:52:57 - AES_Enc - DEBUG - finish
2024/09/16 05:52:57 - AES_Enc - DEBUG - ---2--dataHash: Y
2024/09/16 05:52:57 - AES_Enc - DEBUG - ---2--onlyHash: Y
2024/09/16 05:52:57 - AES_Enc - DEBUG - ---33333--tableName_: sys_telco
2024/09/16 05:52:57 - AES_Enc - DEBUG - Output path: /home/hadoop/proj_/dataMac/output
2024/09/16 05:52:57 - AES_Enc - DEBUG - header : ['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5', 'col_6', 'col_7', 'col_8', 'col_9', 'col_10', 'col_11', 'col_12', 'col_13', 'col_14', 'col_15', 'col_16', 'col_17', 'col_18', 'col_19', 'col_20', 'col_21']
2024/09/16 05:53:05 - AES_Enc - DEBUG - export data succeed.
2024/09/16 05:53:05 - AES_Enc - DEBUG - column name: SEQN
2024/09/16 05:53:06 - AES_Enc - DEBUG - anormal count: 7043 normal count: 0 total count: 7043
2024/09/16 05:53:06 - AES_Enc - DEBUG - out_json: {'enc_key': '588DB940974E745952F0D0BC85ED2DEABE176D3E8ED59E961375C1018EB8C6D5,588DB940974E745952F0D0BC85ED2DEABE176D3E8ED59E961375C1018EB8C6D5', 'col_name': 'customerID,gender,SeniorCitizen,Partner,Dependents,tenure,PhoneService,MultipleLines,InternetService,OnlineSecurity,OnlineBackup,DeviceProtection,TechSupport,StreamingTV,StreamingMovies,Contract,PaperlessBilling,PaymentMethod,MonthlyCharges,TotalCharges,Churn,SEQN', 'col_setting': 'No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,AES', 'enc_datasetname': 'sys_telco.csv', 'ds_count': '7043'}
2024/09/16 05:53:06 - AES_Enc - DEBUG - ============end=======================/home/hadoop/proj_/dataMac/output/A1_telco_k_5
2024/09/16 05:53:06 - AES_Enc - DEBUG - remove hdfs_path = /tmp/telco.csv
2024/09/16 05:53:08 - AES_Enc - DEBUG - remove hdfs file result = b'24/09/16 05:53:07 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.\n'
2024/09/16 05:53:08 - AES_Enc - DEBUG -  AAAAAAAAAA-telco.csv rm ok
2024/09/16 05:53:08 - AES_Enc - DEBUG - itri-pedsa
2024/09/16 05:53:08 - AES_Enc - DEBUG - /home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder
2024/09/16 05:53:08 - AES_Enc - DEBUG - %%%%%%%%%%%%%%%%%%
2024/09/16 05:53:08 - AES_Enc - DEBUG - ============cmd_send=======================
2024/09/16 05:53:08 - AES_Enc - DEBUG - cmd_send:scp -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem -P 22 -r /home/hadoop/proj_/dataMac/output/A1_telco_k_5 itri-pedsa@34.81.119.49:/home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder
2024/09/16 05:53:08 - AES_Enc - DEBUG - mod_str:chmod 755 /home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder/A1_telco_k_5
2024/09/16 05:53:08 - AES_Enc - DEBUG - ============ cmd_chmod =======================
2024/09/16 05:53:08 - AES_Enc - DEBUG - cmd_chmod:ssh -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem itri-pedsa@34.81.119.49 'chmod 755 /home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder/A1_telco_k_5'
2024/09/16 05:53:08 - AES_Enc - DEBUG - b''
2024/09/16 05:53:08 - AES_Enc - DEBUG - b"Warning: Permanently added '34.81.119.49' (ED25519) to the list of known hosts.\r\nchmod: cannot access '/home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder/A1_telco_k_5': No such file or directory\n"
2024/09/16 05:53:09 - AES_Enc - DEBUG - b''
2024/09/16 05:53:09 - AES_Enc - DEBUG - b"Warning: Permanently added '34.81.119.49' (ED25519) to the list of known hosts.\r\n"
2024/09/16 05:53:09 - AES_Enc - DEBUG - ============AES_Enc end=======================
2024/09/16 05:53:09 - AES_Enc - DEBUG - insert T_Pets_ProjectStatus fail: errTable: Insert to PetsService.T_Pets_ProjectStatus fail: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`PetsService`.`T_Pets_ProjectStatus`, CONSTRAINT `T_Pets_ProjectStatus_ibfk_1` FOREIGN KEY (`project_id`) REFERENCES `T_Pets_Project` (`project_id`))')
2024/09/16 06:00:59 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/09/16 06:00:59 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/09/16 06:00:59 - AES_Enc - DEBUG - spark_import_projID_999
2024/09/16 06:00:59 - AES_Enc - DEBUG - MAC_columns_mac:
2024/09/16 06:00:59 - AES_Enc - DEBUG - AES_columns_mac:SEQN
2024/09/16 06:00:59 - AES_Enc - DEBUG - onlyHash:Y
2024/09/16 06:00:59 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/09/16 06:00:59 - AES_Enc - DEBUG - spark_import_userId_1
2024/09/16 06:00:59 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/09/16 06:00:59 - AES_Enc - DEBUG - project_cert = eyJncm91cF90eXBlIjoic3lzIiwiZW5jX2tleSI6IjJFNkMzMzIzMzM5RTgwNkY4M0VCNjZCRjI4NDIwNkVEMTY1MjYyRTQ0RUJDQzVGN0Y0REMxMTk4NTJBODQ3M0EiLCJwcm9qZWN0X25hbWUiOiJBMV90ZWxjb19rXzEwIiwicHJvamVjdF9mb2xkZXIiOiJBMV90ZWxjb19rXzEwIiwicGV0c19zZXJ2aWNlX2lwIjoicGVkc2FzLm1vZGEuZ292LnR3In0=
2024/09/16 06:00:59 - AES_Enc - DEBUG - group_type = sys
2024/09/16 06:00:59 - AES_Enc - DEBUG - Mac_hashkey:2E6C3323339E806F83EB66BF284206ED165262E44EBCC5F7F4DC119852A8473A
2024/09/16 06:00:59 - AES_Enc - DEBUG - AES_hashkey:2E6C3323339E806F83EB66BF284206ED165262E44EBCC5F7F4DC119852A8473A
2024/09/16 06:00:59 - AES_Enc - DEBUG - AES key : 2E6C3323339E806F83EB66BF284206ED165262E44EBCC5F7F4DC119852A8473A
2024/09/16 06:00:59 - AES_Enc - DEBUG - Mac key : 2E6C3323339E806F83EB66BF284206ED165262E44EBCC5F7F4DC119852A8473A
2024/09/16 06:00:59 - AES_Enc - DEBUG - projName: A1_telco_k_10
2024/09/16 06:00:59 - AES_Enc - DEBUG - project_folder: A1_telco_k_10
2024/09/16 06:00:59 - AES_Enc - DEBUG - pets_service_ip : pedsas.moda.gov.tw
2024/09/16 06:00:59 - AES_Enc - DEBUG - AES password ok
2024/09/16 06:00:59 - AES_Enc - DEBUG - Mac password ok
2024/09/16 06:00:59 - AES_Enc - DEBUG - AES columns name will be maced: ['SEQN']
2024/09/16 06:00:59 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/09/16 06:01:13 - AES_Enc - DEBUG - cmd is echo "citcw200@" | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 06:01:13 - AES_Enc - DEBUG - run result is 0
2024/09/16 06:01:13 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 06:01:13 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/09/16 06:01:13 - AES_Enc - DEBUG - ============start======================
2024/09/16 06:01:13 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 06:01:13 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/09/16 06:01:13 - AES_Enc - DEBUG - AES columns name will be maced: ['SEQN']
2024/09/16 06:01:13 - AES_Enc - DEBUG - remove hdfs_path = /tmp/telco.csv
2024/09/16 06:01:15 - AES_Enc - DEBUG - remove hdfs file result = 
2024/09/16 06:01:15 - AES_Enc - DEBUG -  AAAAAAAAAA-telco.csv exist before , rm ok
2024/09/16 06:01:15 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/09/16 06:01:15 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 06:01:15 - AES_Enc - DEBUG - sep: ,
2024/09/16 06:01:15 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/telco.csv
2024/09/16 06:01:17 - AES_Enc - DEBUG - BBBBresult = 
2024/09/16 06:01:17 - AES_Enc - DEBUG - In readLocalData
2024/09/16 06:01:21 - AES_Enc - DEBUG - header valuse = ['customerID', 'gender', 'SeniorCitizen', 'Partner', 'Dependents', 'tenure', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'Churn', 'SEQN']
2024/09/16 06:01:21 - AES_Enc - DEBUG - In checkListQuotes header
2024/09/16 06:01:21 - AES_Enc - DEBUG - In checkListQuotes record
2024/09/16 06:01:21 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/09/16 06:01:21 - AES_Enc - DEBUG - {'col_0': 'customerID', 'col_1': 'gender', 'col_2': 'SeniorCitizen', 'col_3': 'Partner', 'col_4': 'Dependents', 'col_5': 'tenure', 'col_6': 'PhoneService', 'col_7': 'MultipleLines', 'col_8': 'InternetService', 'col_9': 'OnlineSecurity', 'col_10': 'OnlineBackup', 'col_11': 'DeviceProtection', 'col_12': 'TechSupport', 'col_13': 'StreamingTV', 'col_14': 'StreamingMovies', 'col_15': 'Contract', 'col_16': 'PaperlessBilling', 'col_17': 'PaymentMethod', 'col_18': 'MonthlyCharges', 'col_19': 'TotalCharges', 'col_20': 'Churn', 'col_21': 'SEQN'}
2024/09/16 06:01:21 - AES_Enc - DEBUG - ['customerID', 'gender', 'SeniorCitizen', 'Partner', 'Dependents', 'tenure', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'Churn', 'SEQN']
2024/09/16 06:01:21 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5', 'col_6', 'col_7', 'col_8', 'col_9', 'col_10', 'col_11', 'col_12', 'col_13', 'col_14', 'col_15', 'col_16', 'col_17', 'col_18', 'col_19', 'col_20', 'col_21']
2024/09/16 06:01:21 - AES_Enc - DEBUG -  readFrom_csv OK
2024/09/16 06:01:21 - AES_Enc - DEBUG - ============start2======================
2024/09/16 06:01:21 - AES_Enc - DEBUG - ###################out udfMac table name
2024/09/16 06:01:21 - AES_Enc - DEBUG - citc____telco
2024/09/16 06:01:21 - AES_Enc - DEBUG - ###################sc.applicationId
2024/09/16 06:01:21 - AES_Enc - DEBUG - citc____application_1724401035269_0022
2024/09/16 06:01:21 - AES_Enc - DEBUG - ---++++--cols: ['col_21']
2024/09/16 06:01:21 - AES_Enc - DEBUG - ---++++--AES key_: 2E6C3323339E806F83EB66BF284206ED165262E44EBCC5F7F4DC119852A8473A
2024/09/16 06:01:21 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/09/16 06:01:21 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/09/16 06:01:21 - AES_Enc - DEBUG - ---++++--MAC key_: 2E6C3323339E806F83EB66BF284206ED165262E44EBCC5F7F4DC119852A8473A
2024/09/16 06:01:21 - AES_Enc - DEBUG - enter
2024/09/16 06:01:21 - AES_Enc - DEBUG - enter
2024/09/16 06:01:21 - AES_Enc - DEBUG - in udfMacCols
2024/09/16 06:01:22 - AES_Enc - DEBUG - col finishy
2024/09/16 06:01:22 - AES_Enc - DEBUG - AES and MAC = ['col_21'] []
2024/09/16 06:01:22 - AES_Enc - DEBUG - col name before
2024/09/16 06:01:22 - AES_Enc - DEBUG - MAC_KEY = 2E6C3323339E806F83EB66BF284206ED165262E44EBCC5F7F4DC119852A8473A
2024/09/16 06:01:22 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5', 'col_6', 'col_7', 'col_8', 'col_9', 'col_10', 'col_11', 'col_12', 'col_13', 'col_14', 'col_15', 'col_16', 'col_17', 'col_18', 'col_19', 'col_20', 'col_21']
2024/09/16 06:01:22 - AES_Enc - DEBUG - before extend
2024/09/16 06:01:22 - AES_Enc - DEBUG - ['col_21']
2024/09/16 06:01:22 - AES_Enc - DEBUG - before tmpList
2024/09/16 06:01:22 - AES_Enc - DEBUG - after tmpList
2024/09/16 06:01:22 - AES_Enc - DEBUG - finish
2024/09/16 06:01:22 - AES_Enc - DEBUG - ---2--dataHash: Y
2024/09/16 06:01:22 - AES_Enc - DEBUG - ---2--onlyHash: Y
2024/09/16 06:01:22 - AES_Enc - DEBUG - ---33333--tableName_: sys_telco
2024/09/16 06:01:22 - AES_Enc - DEBUG - Output path: /home/hadoop/proj_/dataMac/output
2024/09/16 06:01:22 - AES_Enc - DEBUG - header : ['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5', 'col_6', 'col_7', 'col_8', 'col_9', 'col_10', 'col_11', 'col_12', 'col_13', 'col_14', 'col_15', 'col_16', 'col_17', 'col_18', 'col_19', 'col_20', 'col_21']
2024/09/16 06:01:31 - AES_Enc - DEBUG - export data succeed.
2024/09/16 06:01:31 - AES_Enc - DEBUG - column name: SEQN
2024/09/16 06:01:31 - AES_Enc - DEBUG - anormal count: 7043 normal count: 0 total count: 7043
2024/09/16 06:01:31 - AES_Enc - DEBUG - out_json: {'enc_key': '2E6C3323339E806F83EB66BF284206ED165262E44EBCC5F7F4DC119852A8473A,2E6C3323339E806F83EB66BF284206ED165262E44EBCC5F7F4DC119852A8473A', 'col_name': 'customerID,gender,SeniorCitizen,Partner,Dependents,tenure,PhoneService,MultipleLines,InternetService,OnlineSecurity,OnlineBackup,DeviceProtection,TechSupport,StreamingTV,StreamingMovies,Contract,PaperlessBilling,PaymentMethod,MonthlyCharges,TotalCharges,Churn,SEQN', 'col_setting': 'No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,AES', 'enc_datasetname': 'sys_telco.csv', 'ds_count': '7043'}
2024/09/16 06:01:31 - AES_Enc - DEBUG - ============end=======================/home/hadoop/proj_/dataMac/output/A1_telco_k_10
2024/09/16 06:01:31 - AES_Enc - DEBUG - remove hdfs_path = /tmp/telco.csv
2024/09/16 06:01:33 - AES_Enc - DEBUG - remove hdfs file result = b'24/09/16 06:01:32 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.\n'
2024/09/16 06:01:33 - AES_Enc - DEBUG -  AAAAAAAAAA-telco.csv rm ok
2024/09/16 06:01:33 - AES_Enc - DEBUG - itri-pedsa
2024/09/16 06:01:33 - AES_Enc - DEBUG - /home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder
2024/09/16 06:01:33 - AES_Enc - DEBUG - %%%%%%%%%%%%%%%%%%
2024/09/16 06:01:33 - AES_Enc - DEBUG - ============cmd_send=======================
2024/09/16 06:01:33 - AES_Enc - DEBUG - cmd_send:scp -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem -P 22 -r /home/hadoop/proj_/dataMac/output/A1_telco_k_10 itri-pedsa@34.81.119.49:/home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder
2024/09/16 06:01:33 - AES_Enc - DEBUG - mod_str:chmod 755 /home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder/A1_telco_k_10
2024/09/16 06:01:33 - AES_Enc - DEBUG - ============ cmd_chmod =======================
2024/09/16 06:01:33 - AES_Enc - DEBUG - cmd_chmod:ssh -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem itri-pedsa@34.81.119.49 'chmod 755 /home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder/A1_telco_k_10'
2024/09/16 06:01:34 - AES_Enc - DEBUG - b''
2024/09/16 06:01:34 - AES_Enc - DEBUG - b"Warning: Permanently added '34.81.119.49' (ED25519) to the list of known hosts.\r\nchmod: cannot access '/home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder/A1_telco_k_10': No such file or directory\n"
2024/09/16 06:01:34 - AES_Enc - DEBUG - b''
2024/09/16 06:01:34 - AES_Enc - DEBUG - b"Warning: Permanently added '34.81.119.49' (ED25519) to the list of known hosts.\r\n"
2024/09/16 06:01:34 - AES_Enc - DEBUG - ============AES_Enc end=======================
2024/09/16 06:01:34 - AES_Enc - DEBUG - insert T_Pets_ProjectStatus fail: errTable: Insert to PetsService.T_Pets_ProjectStatus fail: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`PetsService`.`T_Pets_ProjectStatus`, CONSTRAINT `T_Pets_ProjectStatus_ibfk_1` FOREIGN KEY (`project_id`) REFERENCES `T_Pets_Project` (`project_id`))')
2024/09/16 06:05:48 - AES_Enc - DEBUG - spark_import_dbName_enc_output
2024/09/16 06:05:48 - AES_Enc - DEBUG - spark_import_projName_enc_output
2024/09/16 06:05:48 - AES_Enc - DEBUG - spark_import_projID_999
2024/09/16 06:05:48 - AES_Enc - DEBUG - MAC_columns_mac:
2024/09/16 06:05:48 - AES_Enc - DEBUG - AES_columns_mac:SEQN
2024/09/16 06:05:48 - AES_Enc - DEBUG - onlyHash:Y
2024/09/16 06:05:48 - AES_Enc - DEBUG - spark_import_userAccount_deidadmin
2024/09/16 06:05:48 - AES_Enc - DEBUG - spark_import_userId_1
2024/09/16 06:05:48 - AES_Enc - DEBUG - spark_import_service_ip_34.81.119.49
2024/09/16 06:05:48 - AES_Enc - DEBUG - project_cert = eyJncm91cF90eXBlIjoic3lzIiwiZW5jX2tleSI6IjAwNzE4NkU4QUM0NUNEMEYwMDhFMUYzQ0FCQTE3QTgzOUNDRjE3RDRCNEREOUZGNTBCMDU4NTI3QzIyN0QwQzYiLCJwcm9qZWN0X25hbWUiOiJBMV90ZWxjb19rXzIwIiwicHJvamVjdF9mb2xkZXIiOiJBMV90ZWxjb19rXzIwIiwicGV0c19zZXJ2aWNlX2lwIjoicGVkc2FzLm1vZGEuZ292LnR3In0=
2024/09/16 06:05:48 - AES_Enc - DEBUG - group_type = sys
2024/09/16 06:05:48 - AES_Enc - DEBUG - Mac_hashkey:007186E8AC45CD0F008E1F3CABA17A839CCF17D4B4DD9FF50B058527C227D0C6
2024/09/16 06:05:48 - AES_Enc - DEBUG - AES_hashkey:007186E8AC45CD0F008E1F3CABA17A839CCF17D4B4DD9FF50B058527C227D0C6
2024/09/16 06:05:48 - AES_Enc - DEBUG - AES key : 007186E8AC45CD0F008E1F3CABA17A839CCF17D4B4DD9FF50B058527C227D0C6
2024/09/16 06:05:48 - AES_Enc - DEBUG - Mac key : 007186E8AC45CD0F008E1F3CABA17A839CCF17D4B4DD9FF50B058527C227D0C6
2024/09/16 06:05:48 - AES_Enc - DEBUG - projName: A1_telco_k_20
2024/09/16 06:05:48 - AES_Enc - DEBUG - project_folder: A1_telco_k_20
2024/09/16 06:05:48 - AES_Enc - DEBUG - pets_service_ip : pedsas.moda.gov.tw
2024/09/16 06:05:48 - AES_Enc - DEBUG - AES password ok
2024/09/16 06:05:48 - AES_Enc - DEBUG - Mac password ok
2024/09/16 06:05:48 - AES_Enc - DEBUG - AES columns name will be maced: ['SEQN']
2024/09/16 06:05:48 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/09/16 06:06:02 - AES_Enc - DEBUG - cmd is echo "citcw200@" | sudo -S chown hadoop:hadoop /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 06:06:02 - AES_Enc - DEBUG - run result is 0
2024/09/16 06:06:02 - AES_Enc - DEBUG - Input path: /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 06:06:02 - AES_Enc - DEBUG - ----for decry----isEnc: 0
2024/09/16 06:06:02 - AES_Enc - DEBUG - ============start======================
2024/09/16 06:06:02 - AES_Enc - DEBUG - input file: /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 06:06:02 - AES_Enc - DEBUG - MAC columns name will be maced: []
2024/09/16 06:06:02 - AES_Enc - DEBUG - AES columns name will be maced: ['SEQN']
2024/09/16 06:06:02 - AES_Enc - DEBUG - remove hdfs_path = /tmp/telco.csv
2024/09/16 06:06:04 - AES_Enc - DEBUG - remove hdfs file result = 
2024/09/16 06:06:04 - AES_Enc - DEBUG -  AAAAAAAAAA-telco.csv exist before , rm ok
2024/09/16 06:06:04 - AES_Enc - DEBUG - In readFrom_csv_wit_NA_Normalize
2024/09/16 06:06:04 - AES_Enc - DEBUG - path_: /home/hadoop/proj_/dataMac/input/telco.csv
2024/09/16 06:06:04 - AES_Enc - DEBUG - sep: ,
2024/09/16 06:06:04 - AES_Enc - DEBUG - BBBB hdfs_path = /tmp/telco.csv
2024/09/16 06:06:06 - AES_Enc - DEBUG - BBBBresult = 
2024/09/16 06:06:06 - AES_Enc - DEBUG - In readLocalData
2024/09/16 06:06:10 - AES_Enc - DEBUG - header valuse = ['customerID', 'gender', 'SeniorCitizen', 'Partner', 'Dependents', 'tenure', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'Churn', 'SEQN']
2024/09/16 06:06:10 - AES_Enc - DEBUG - In checkListQuotes header
2024/09/16 06:06:10 - AES_Enc - DEBUG - In checkListQuotes record
2024/09/16 06:06:10 - AES_Enc - DEBUG - Check headerRaw and headerTmp
2024/09/16 06:06:10 - AES_Enc - DEBUG - {'col_0': 'customerID', 'col_1': 'gender', 'col_2': 'SeniorCitizen', 'col_3': 'Partner', 'col_4': 'Dependents', 'col_5': 'tenure', 'col_6': 'PhoneService', 'col_7': 'MultipleLines', 'col_8': 'InternetService', 'col_9': 'OnlineSecurity', 'col_10': 'OnlineBackup', 'col_11': 'DeviceProtection', 'col_12': 'TechSupport', 'col_13': 'StreamingTV', 'col_14': 'StreamingMovies', 'col_15': 'Contract', 'col_16': 'PaperlessBilling', 'col_17': 'PaymentMethod', 'col_18': 'MonthlyCharges', 'col_19': 'TotalCharges', 'col_20': 'Churn', 'col_21': 'SEQN'}
2024/09/16 06:06:10 - AES_Enc - DEBUG - ['customerID', 'gender', 'SeniorCitizen', 'Partner', 'Dependents', 'tenure', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'Churn', 'SEQN']
2024/09/16 06:06:10 - AES_Enc - DEBUG - ['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5', 'col_6', 'col_7', 'col_8', 'col_9', 'col_10', 'col_11', 'col_12', 'col_13', 'col_14', 'col_15', 'col_16', 'col_17', 'col_18', 'col_19', 'col_20', 'col_21']
2024/09/16 06:06:10 - AES_Enc - DEBUG -  readFrom_csv OK
2024/09/16 06:06:10 - AES_Enc - DEBUG - ============start2======================
2024/09/16 06:06:10 - AES_Enc - DEBUG - ###################out udfMac table name
2024/09/16 06:06:10 - AES_Enc - DEBUG - citc____telco
2024/09/16 06:06:10 - AES_Enc - DEBUG - ###################sc.applicationId
2024/09/16 06:06:10 - AES_Enc - DEBUG - citc____application_1724401035269_0023
2024/09/16 06:06:11 - AES_Enc - DEBUG - ---++++--cols: ['col_21']
2024/09/16 06:06:11 - AES_Enc - DEBUG - ---++++--AES key_: 007186E8AC45CD0F008E1F3CABA17A839CCF17D4B4DD9FF50B058527C227D0C6
2024/09/16 06:06:11 - AES_Enc - DEBUG - ---++++--isEnc: 0
2024/09/16 06:06:11 - AES_Enc - DEBUG - ---++++--MAC cols: []
2024/09/16 06:06:11 - AES_Enc - DEBUG - ---++++--MAC key_: 007186E8AC45CD0F008E1F3CABA17A839CCF17D4B4DD9FF50B058527C227D0C6
2024/09/16 06:06:11 - AES_Enc - DEBUG - enter
2024/09/16 06:06:11 - AES_Enc - DEBUG - enter
2024/09/16 06:06:11 - AES_Enc - DEBUG - in udfMacCols
2024/09/16 06:06:11 - AES_Enc - DEBUG - col finishy
2024/09/16 06:06:11 - AES_Enc - DEBUG - AES and MAC = ['col_21'] []
2024/09/16 06:06:11 - AES_Enc - DEBUG - col name before
2024/09/16 06:06:11 - AES_Enc - DEBUG - MAC_KEY = 007186E8AC45CD0F008E1F3CABA17A839CCF17D4B4DD9FF50B058527C227D0C6
2024/09/16 06:06:11 - AES_Enc - DEBUG - df3 head =['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5', 'col_6', 'col_7', 'col_8', 'col_9', 'col_10', 'col_11', 'col_12', 'col_13', 'col_14', 'col_15', 'col_16', 'col_17', 'col_18', 'col_19', 'col_20', 'col_21']
2024/09/16 06:06:11 - AES_Enc - DEBUG - before extend
2024/09/16 06:06:11 - AES_Enc - DEBUG - ['col_21']
2024/09/16 06:06:11 - AES_Enc - DEBUG - before tmpList
2024/09/16 06:06:11 - AES_Enc - DEBUG - after tmpList
2024/09/16 06:06:11 - AES_Enc - DEBUG - finish
2024/09/16 06:06:11 - AES_Enc - DEBUG - ---2--dataHash: Y
2024/09/16 06:06:11 - AES_Enc - DEBUG - ---2--onlyHash: Y
2024/09/16 06:06:11 - AES_Enc - DEBUG - ---33333--tableName_: sys_telco
2024/09/16 06:06:11 - AES_Enc - DEBUG - Output path: /home/hadoop/proj_/dataMac/output
2024/09/16 06:06:11 - AES_Enc - DEBUG - header : ['col_0', 'col_1', 'col_2', 'col_3', 'col_4', 'col_5', 'col_6', 'col_7', 'col_8', 'col_9', 'col_10', 'col_11', 'col_12', 'col_13', 'col_14', 'col_15', 'col_16', 'col_17', 'col_18', 'col_19', 'col_20', 'col_21']
2024/09/16 06:06:20 - AES_Enc - DEBUG - export data succeed.
2024/09/16 06:06:20 - AES_Enc - DEBUG - column name: SEQN
2024/09/16 06:06:21 - AES_Enc - DEBUG - anormal count: 7043 normal count: 0 total count: 7043
2024/09/16 06:06:21 - AES_Enc - DEBUG - out_json: {'enc_key': '007186E8AC45CD0F008E1F3CABA17A839CCF17D4B4DD9FF50B058527C227D0C6,007186E8AC45CD0F008E1F3CABA17A839CCF17D4B4DD9FF50B058527C227D0C6', 'col_name': 'customerID,gender,SeniorCitizen,Partner,Dependents,tenure,PhoneService,MultipleLines,InternetService,OnlineSecurity,OnlineBackup,DeviceProtection,TechSupport,StreamingTV,StreamingMovies,Contract,PaperlessBilling,PaymentMethod,MonthlyCharges,TotalCharges,Churn,SEQN', 'col_setting': 'No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,No_setting,AES', 'enc_datasetname': 'sys_telco.csv', 'ds_count': '7043'}
2024/09/16 06:06:21 - AES_Enc - DEBUG - ============end=======================/home/hadoop/proj_/dataMac/output/A1_telco_k_20
2024/09/16 06:06:21 - AES_Enc - DEBUG - remove hdfs_path = /tmp/telco.csv
2024/09/16 06:06:22 - AES_Enc - DEBUG - remove hdfs file result = b'24/09/16 06:06:22 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.\n'
2024/09/16 06:06:22 - AES_Enc - DEBUG -  AAAAAAAAAA-telco.csv rm ok
2024/09/16 06:06:22 - AES_Enc - DEBUG - itri-pedsa
2024/09/16 06:06:22 - AES_Enc - DEBUG - /home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder
2024/09/16 06:06:22 - AES_Enc - DEBUG - %%%%%%%%%%%%%%%%%%
2024/09/16 06:06:22 - AES_Enc - DEBUG - ============cmd_send=======================
2024/09/16 06:06:22 - AES_Enc - DEBUG - cmd_send:scp -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem -P 22 -r /home/hadoop/proj_/dataMac/output/A1_telco_k_20 itri-pedsa@34.81.119.49:/home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder
2024/09/16 06:06:22 - AES_Enc - DEBUG - mod_str:chmod 755 /home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder/A1_telco_k_20
2024/09/16 06:06:22 - AES_Enc - DEBUG - ============ cmd_chmod =======================
2024/09/16 06:06:22 - AES_Enc - DEBUG - cmd_chmod:ssh -i /home/hadoop/proj_/longTaskDir/sftp_keys/sftp_key.pem itri-pedsa@34.81.119.49 'chmod 755 /home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder/A1_telco_k_20'
2024/09/16 06:06:23 - AES_Enc - DEBUG - b''
2024/09/16 06:06:23 - AES_Enc - DEBUG - b"Warning: Permanently added '34.81.119.49' (ED25519) to the list of known hosts.\r\nchmod: cannot access '/home/itri-pedsa/pedsa_s/pets_service/sftp_upload_folder/A1_telco_k_20': No such file or directory\n"
2024/09/16 06:06:23 - AES_Enc - DEBUG - b''
2024/09/16 06:06:23 - AES_Enc - DEBUG - b"Warning: Permanently added '34.81.119.49' (ED25519) to the list of known hosts.\r\n"
2024/09/16 06:06:23 - AES_Enc - DEBUG - ============AES_Enc end=======================
2024/09/16 06:06:23 - AES_Enc - DEBUG - insert T_Pets_ProjectStatus fail: errTable: Insert to PetsService.T_Pets_ProjectStatus fail: (1452, 'Cannot add or update a child row: a foreign key constraint fails (`PetsService`.`T_Pets_ProjectStatus`, CONSTRAINT `T_Pets_ProjectStatus_ibfk_1` FOREIGN KEY (`project_id`) REFERENCES `T_Pets_Project` (`project_id`))')
